<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Exo Planet Visualizations</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
	</head>
	<body>
		<h1>Exoplanet Visualizations</h1> 
		<svg></svg>
		<form>
			<div class="btn-group">		
			  <button type="button" class="btn btn-primary" onclick="window.location.href='http://natsoule.github.io/Viz498/exoscatter.html'">Next</button>
			</div>
			<div class="btn-group">
				<button type="button" id="writeup-btn" class="btn">About the Visualization</button>
			</div>
		</form>
		<div class="card" id="about">
			<div class="card-header">About the Visualization</div>
			<div class="card-body">Content</div>
		</div>
	</body>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<script>
  
	/*scatter plot viz*/
	var margin = {top: 20, right: 20, bottom: 30, left: 40},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

	var x = d3.scaleLinear()
		.range([0, width]);

	var y = d3.scaleLog().base(10)
		.range([height, 0]);
  
	var xaxis = d3.axisBottom()
		.scale(x);

	var yaxis = d3.axisLeft()
		.scale(y);
  
	var color = d3.scaleOrdinal(d3.schemeCategory20);
	//var symbols = d3.scaleOrdinal(d3.symbols);

	var symbol = d3.symbol().size(100);
  
	var svg = d3.selectAll("svg")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.append("g")
		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

	d3.csv('exoplanets_discovery_over_time.csv', function(error, data){
		data.forEach(function(d){
			d.method = d.method;
			d.year  = +d.year;
			d.count = +d.count;
		});

		x.domain([1989, 2022]).nice();

		y.domain([1,2000]).nice();
	  
		svg.append('g')
			.attr('transform', 'translate(0,' + height + ')')
			.attr('class', 'x axis')
			.call(xaxis);

		svg.append('g')
			.attr('transform', 'translate(0,0)')
			.attr('class', 'y axis')
			.call(yaxis);

		svg.append('text')
			.attr('x', 10)
			.attr('y', 10)
			.attr('class', 'label')
			.text('number of planets discovered');

		svg.append('text')
			.attr('x', width)
			.attr('y', height - 10)
			.attr('text-anchor', 'end')
			.attr('class', 'label')
			.text('discovery year');
		
		// we use the ordinal scale symbols to generate symbols
		// such as d3.symbolcross, etc..
		// -> symbol.type(d3.symbolcross)()
		svg.selectAll(".symbol")
			.data(data)
			.enter().append("path")
			.attr("class", "symbol")
			.attr("d", function(d, i) { return symbol.type(d3.symbolSquare)(); })
			.style("fill", function(d) { return color(d.method); })			
			.attr("transform", function(d) { 
				return "translate(" + x(d.year) + "," + y(d.count) +")"; 
			})
			.append("title").text(function(d) { return 'Method: ' + d.method + "\nYear: " + d.year + "\nCount: " + d.count; });
	  
		var clicked = "";
	  
		var legend = svg.selectAll(".legend")
			.data(color.domain())
			.enter().append("g")
			.attr("class", "legend")
			.attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

		legend.append("path")
			.style("fill", function(d) { return color(d); })
			.attr("d", function(d, i) { return symbol.type(d3.symbolSquare)(); })
			.attr("transform", function(d, i) { 
				return "translate(" + (width -10) + "," + 10 + ")";
			})
			.on("click",function(d){
			
				d3.selectAll(".symbol").style("opacity",1);
				d3.selectAll("line").style("opacity",1);
				d3.selectAll("text").style("opacity",1);
			   
				if (clicked !== d) {
					d3.selectAll(".symbol")
						.filter(function(e){
							return e.method !== d;
					 })
					.style("opacity",0.1);
					 clicked = d;
					 
					if (d==='Radial Velocity')
					{
						d3.selectAll(".transit")
							.style("opacity",0.1);
						d3.selectAll(".micro")
							.style("opacity",0.1);
					}
					else if (d==='Transit')
					{
						d3.selectAll(".radial")
							.style("opacity",0.1);
						d3.selectAll(".micro")
							.style("opacity",0.1);
					}
					else if (d==='Microlensing')
					{
						d3.selectAll(".transit")
							.style("opacity",0.1);
						d3.selectAll(".radial")
							.style("opacity",0.1);
					}
			   }
				else{
				  clicked = "";
				}
		  });
	 
		legend.append("text")
		  .attr("x", width - 24)
		  .attr("y", 9)
		  .attr("dy", ".35em")
		  .style("text-anchor", "end")
		  .text(function(d) { return d; });	  
		  
		  
		  
		<!-- <text y="380"><tspan x="10" dy="0">First exoplanet discovered:</tspan> -->
		<!-- <tspan x="10" dy="15">Gamma Cephei A b</tspan></text> -->
		<!-- <line x1="60" y1="400" x2="90" y2="445" stroke="black"></line> -->
		
		/*Annotations*/
		var lbl1 = svg.append('text')
			.attr('y', 380)
			.attr('class','radial');
		lbl1.append("tspan")
			.attr("x",10)
			.attr("dy",0)
			.text("First exoplanet discovered:");
		lbl1.append("tspan")
			.attr("x",10)
			.attr("dy",15)
			.text("Gamma Cephei A b");
		svg.append("line")
			.attr("x1",60)
			.attr("y1",400)
			.attr("x2",90)
			.attr("y2",445)
			.attr("stroke","black")
			.attr('class','radial');

		
		<!-- <text y="220"><tspan x="250" dy="0">HARPS installed at La Silla</tspan><tspan x="250" dy="15">Observatory in Chile</tspan> -->
		<!-- <tspan x="250" dy="15">Method: Radial Velocity</tspan></text>	 -->
		<!-- <line x1="320" y1="255" x2="380" y2="282" stroke="black"></line> -->
		
		/*Annotations*/
		var lbl2 = svg.append('text')
			.attr('y', 220)
			.attr('class','radial');
		lbl2.append("tspan")
			.attr("x",250)
			.attr("dy",0)
			.text("HARPS installed at La Silla");
		lbl2.append("tspan")
			.attr("x",250)
			.attr("dy",15)
			.text("Observatory in Chile");
		lbl2.append("tspan")
			.attr("x",250)
			.attr("dy",15)
			.text("Method: Radial Velocity");
		svg.append("line")
			.attr("x1",320)
			.attr("y1",255)
			.attr("x2",380)
			.attr("y2",282)
			.attr("stroke","black")
			.attr('class','radial');
			
		<!-- <text y="140"><tspan x="400" dy="0">Keppler Telescope Launched</tspan><tspan x="400" dy="15">Method: Transit</tspan> -->
		<!-- </text> -->
		<!-- <line x1="500" y1="155" x2="540" y2="305" stroke="black"></line> -->
			
		var lbl3 = svg.append('text')
			.attr('y', 140)
			.attr('class','transit');
		lbl3.append("tspan")
			.attr("x",400)
			.attr("dy",0)
			.text("Keppler Telescope Launched");
		lbl3.append("tspan")
			.attr("x",400)
			.attr("dy",15)
			.text("Method: Transit");
		svg.append("line")
			.attr("x1",500)
			.attr("y1",155)
			.attr("x2",540)
			.attr("y2",305)
			.attr("stroke","black")
			.attr('class','transit');
			
		<!-- <text y="390"><tspan x="240" dy="0">First successful microlensing</tspan><tspan x="240" dy="15">discovery at OGLE</tspan> -->
		<!-- </text> -->
		<!-- <line x1="300" y1="407" x2="425" y2="445" stroke="black"></line> -->
		
		var lbl4 = svg.append('text')
			.attr('y', 390)
			.attr('class','micro');
		lbl4.append("tspan")
			.attr("x",240)
			.attr("dy",0)
			.text("First successful microlensing");
		lbl4.append("tspan")
			.attr("x",240)
			.attr("dy",15)
			.text("discovery at OGLE");
		svg.append("line")
			.attr("x1",300)
			.attr("y1",407)
			.attr("x2",425)
			.attr("y2",445)
			.attr("stroke","black")
			.attr('class','micro');
	});
	
	//writeup button behavior
	$('#writeup-btn').click(function() {
		$('#about').toggle();
	});
	
  </script>
</html>
